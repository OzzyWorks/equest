<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>ENGLISH QUEST 230 - Final</title>
  <style>
    html, body { height: 100%; margin: 0; padding: 0; overflow: hidden; background: #1a1a2e; color: #fff; font-family: sans-serif; }
    body { display: flex; flex-direction: column; box-sizing: border-box; padding: 8px; }
    h1 { font-size: 0.9rem; margin: 0 0 5px 0; text-align: center; color: #eccc68; }
    #status { display: flex; justify-content: space-around; background: rgba(255,255,255,0.1); padding: 5px; font-size: 0.75rem; border-radius: 8px; flex-shrink: 0; }
    
    #monster-area { flex: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; min-height: 0; }
    #monster-image { font-size: 10vh; margin: 2px 0; transition: transform 0.2s; }
    #monster-name { font-size: 0.85rem; margin: 2px 0; font-weight: bold; }
    .hp-bar-container { width: 60%; height: 6px; background: #333; border-radius: 3px; overflow: hidden; }
    #monster-hp { height: 100%; background: #ff4757; width: 100%; transition: width 0.3s; }
    
    #question-area { flex: 1.5; display: flex; flex-direction: column; justify-content: center; min-height: 0; padding: 0 5px; }
    #question { font-size: 0.85rem; margin-bottom: 8px; color: #ffa502; font-weight: bold; text-align: center; min-height: 2.8em; line-height: 1.3; }
    #choices { display: grid; grid-template-columns: 1fr 1fr; gap: 6px; }
    #choices button { padding: 12px 4px; font-size: 0.75rem; border-radius: 6px; border: none; background: #f1f2f6; font-weight: bold; color: #2f3542; cursor: pointer; }
    
    #footer { height: 65px; flex-shrink: 0; display: flex; flex-direction: column; justify-content: center; align-items: center; }
    #log { font-size: 0.75rem; color: #2ed573; margin-bottom: 4px; height: 1rem; font-weight: bold; }
    #next { width: 85%; padding: 10px; font-size: 0.9rem; background: #ff7f50; border: none; border-radius: 20px; color: white; font-weight: bold; display: none; }
    
    .correct { background: #2ed573 !important; color: white !important; }
    .wrong { background: #ff4757 !important; color: white !important; }
  </style>
</head>
<body>
  <h1>‚öîÔ∏è ENGLISH QUEST 230</h1>
  <div id="status">
    <div>LV: <span id="level">1</span></div>
    <div>HP: <span id="hp">100</span></div>
    <div>Â±ûÊÄß: <span id="p-element">üî•</span></div>
  </div>

  <div id="monster-area">
    <div id="monster-image">üêæ</div>
    <div id="monster-name">Loading...</div>
    <div class="hp-bar-container"><div id="monster-hp"></div></div>
    <div id="monster-type" style="font-size: 0.6rem; margin-top:2px;"></div>
  </div>

  <div id="question-area">
    <div id="question"></div>
    <div id="choices"></div>
  </div>

  <div id="footer">
    <div id="log"></div>
    <button id="next">‚ñ∂ Ê¨°„ÅÆ„Éê„Éà„É´„Å∏</button>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      let player = { level: 1, exp: 0, hp: 100, element: "üî•", winCount: 0 };
      const elements = { "üî•": "üíß", "üíß": "üåø", "üåø": "üî•" };

      // ÂÆåÂÖ®Êõ∏„Åç‰∏ã„Çç„Åó 230Âïè„Éá„Éº„Çø
      const masterQuestions = [
        // ÊñáÊ≥ï„ÉªË™ûÊ≥ï
        { q: "He ( ) to school by bike every day.", choices: ["goes", "go", "going", "gone"], a: "goes" },
        { q: "I ( ) my homework yet.", choices: ["haven't finished", "didn't finish", "don't finish", "not finish"], a: "haven't finished" },
        { q: "Look! A boy ( ) in the river.", choices: ["is swimming", "swims", "swam", "swimming"], a: "is swimming" },
        { q: "This is the most ( ) movie I've ever seen.", choices: ["exciting", "excited", "excite", "excites"], a: "exciting" },
        { q: "I ( ) like to visit Canada someday.", choices: ["would", "should", "could", "will"], a: "would" },
        { q: "You ( ) take off your shoes here.", choices: ["must", "may", "can", "will"], a: "must" },
        { q: "The girl ( ) is playing the piano is my sister.", choices: ["who", "which", "whose", "whom"], a: "who" },
        { q: "If it ( ) tomorrow, we will stay home.", choices: ["rains", "will rain", "rain", "rained"], a: "rains" },
        { q: "I was very ( ) to hear the news.", choices: ["surprised", "surprising", "surprise", "surprises"], a: "surprised" },
        { q: "I ( ) breakfast when the phone rang.", choices: ["was eating", "ate", "am eating", "eat"], a: "was eating" }
      ];

      // Ë™ûÂΩô„ÉªÁÜüË™û„ÅÆËøΩÂä†Ôºà„Äåcheck„ÄçÁ≠â„ÅÆÈáçË§á„Å™„ÅóÔºâ
      const vocabs = [
        ["achieve","ÈÅîÊàê„Åô„Çã"],["admire","Áß∞Ë≥õ„Åô„Çã"],["admit","Ë™ç„ÇÅ„Çã"],["affect","ÂΩ±Èüø„Åô„Çã"],["agree","ÂêåÊÑè„Åô„Çã"],
        ["allow","Ë®±ÂèØ„Åô„Çã"],["appear","Áèæ„Çå„Çã"],["apply","Áî≥„ÅóËæº„ÇÄ"],["argue","‰∏ªÂºµ„Åô„Çã"],["arrive","Âà∞ÁùÄ„Åô„Çã"],
        ["avoid","ÈÅø„Åë„Çã"],["become","„Äú„Å´„Å™„Çã"],["believe","‰ø°„Åò„Çã"],["belong","Â±û„Åô„Çã"],["borrow","ÂÄü„Çä„Çã"],
        ["break","Â£ä„Åô"],["bring","ÊåÅ„Å£„Å¶„Åè„Çã"],["build","Âª∫„Å¶„Çã"],["cancel","‰∏≠Ê≠¢„Åô„Çã"],["choose","ÈÅ∏„Å∂"],
        ["collect","ÈõÜ„ÇÅ„Çã"],["compare","ÊØîËºÉ„Åô„Çã"],["complain","‰∏çÂπ≥„ÇíË®Ä„ÅÜ"],["confirm","Á¢∫Ë™ç„Åô„Çã"],["consider","„Çà„ÅèËÄÉ„Åà„Çã"],
        ["create","ÂâµÈÄ†„Åô„Çã"],["damage","ÊêçÂÆ≥„Çí‰∏é„Åà„Çã"],["decide","Ê±∫ÂÆö„Åô„Çã"],["deliver","Â±ä„Åë„Çã"],["depend","‰æùÂ≠ò„Åô„Çã"],
        ["describe","ÊèèÂÜô„Åô„Çã"],["destroy","Á†¥Â£ä„Åô„Çã"],["develop","Áô∫ÈÅî„Åï„Åõ„Çã"],["discover","Áô∫Ë¶ã„Åô„Çã"],["discuss","Ë©±„ÅóÂêà„ÅÜ"],
        ["earn","Á®º„Åê"],["encourage","Âä±„Åæ„Åô"],["enjoy","Ê•Ω„Åó„ÇÄ"],["expect","ÊúüÂæÖ„Åô„Çã"],["explain","Ë™¨Êòé„Åô„Çã"],
        ["explore","Êé¢Ê§ú„Åô„Çã"],["fail","Â§±Êïó„Åô„Çã"],["follow","Âæì„ÅÜ"],["forget","Âøò„Çå„Çã"],["forgive","Ë®±„Åô"],
        ["happen","Ëµ∑„Åì„Çã"],["ignore","ÁÑ°Ë¶ñ„Åô„Çã"],["imagine","ÊÉ≥ÂÉè„Åô„Çã"],["improve","Âêë‰∏ä„Åï„Åõ„Çã"],["include","Âê´„ÇÄ"],
        ["increase","Â¢ó„Åà„Çã"],["indicate","Êåá„ÅóÁ§∫„Åô"],["inform","Áü•„Çâ„Åõ„Çã"],["intend","ÊÑèÂõ≥„Åô„Çã"],["invent","Áô∫Êòé„Åô„Çã"],
        ["involve","Â∑ª„ÅçËæº„ÇÄ"],["judge","Âà§Êñ≠„Åô„Çã"],["keep","‰øù„Å§"],["knock","Âè©„Åè"],["lead","Â∞é„Åè"],
        ["learn","Â≠¶„Å∂"],["leave","Âá∫Áô∫„Åô„Çã"],["lend","Ë≤∏„Åô"],["manage","‰Ωï„Å®„Åã„Åô„Çã"],["measure","Ê∏¨„Çã"],
        ["mention","Ë®ÄÂèä„Åô„Çã"],["notice","Ê∞ó„Å•„Åè"],["offer","Êèê‰æõ„Åô„Çã"],["order","Ê≥®Êñá„Åô„Çã"],["participate","ÂèÇÂä†„Åô„Çã"],
        ["perform","Ë°å„ÅÜ"],["persuade","Ë™¨Âæó„Åô„Çã"],["prepare","Ê∫ñÂÇô„Åô„Çã"],["prevent","Èò≤„Åê"],["produce","ÁîüÁî£„Åô„Çã"],
        ["promise","Á¥ÑÊùü„Åô„Çã"],["protect","‰øùË≠∑„Åô„Çã"],["provide","Êèê‰æõ„Åô„Çã"],["publish","Âá∫Áâà„Åô„Çã"],["realize","Ê∞ó„Å•„Åè"],
        ["receive","Âèó„ÅëÂèñ„Çã"],["recognize","Ë™ç„ÇÅ„Çã"],["recommend","Âãß„ÇÅ„Çã"],["reduce","Ê∏õ„Çâ„Åô"],["refuse","ÊãíÂê¶„Åô„Çã"],
        ["regret","ÂæåÊÇî„Åô„Çã"],["relax","„Åè„Å§„Çç„Åê"],["remain","ÊÆã„Çã"],["remember","Ë¶ö„Åà„Å¶„ÅÑ„Çã"],["remind","ÊÄù„ÅÑÂá∫„Åï„Åõ„Çã"],
        ["remove","Âèñ„ÇäÈô§„Åè"],["repair","‰øÆÁêÜ„Åô„Çã"],["repeat","Áπ∞„ÇäËøî„Åô"],["replace","Âèñ„ÇäÊõø„Åà„Çã"],["reply","Ëøî‰∫ã„Åô„Çã"],
        ["report","Â†±Âëä„Åô„Çã"],["require","ÂøÖË¶Å„Å®„Åô„Çã"],["research","Á†îÁ©∂„Åô„Çã"],["reserve","‰∫àÁ¥Ñ„Åô„Çã"],["respect","Â∞äÊï¨„Åô„Çã"],
        ["respond","ÂèçÂøú„Åô„Çã"],["return","Êàª„Çã"],["reveal","Êòé„Çâ„Åã„Å´„Åô„Çã"],["save","Êïë„ÅÜ"],["search","Êé¢„Åô"],
        ["select","ÈÅ∏Êäû„Åô„Çã"],["separate","ÂàÜ„Åë„Çã"],["share","ÂÖ±Êúâ„Åô„Çã"],["solve","Ëß£Ê±∫„Åô„Çã"],["spend","Ë≤ª„ÇÑ„Åô"],
        ["suggest","ÊèêÊ°à„Åô„Çã"],["support","ÊîØÊåÅ„Åô„Çã"],["survive","Áîü„ÅçÊÆã„Çã"],["teach","Êïô„Åà„Çã"],["travel","ÊóÖË°å„Åô„Çã"],
        ["understand","ÁêÜËß£„Åô„Çã"],["volunteer","ÂøóÈ°ò„Åô„Çã"],["waste","Êµ™Ë≤ª„Åô„Çã"],["wonder","„Äú„Åã„Å™„Å®ÊÄù„ÅÜ"],["worry","ÂøÉÈÖç„Åô„Çã"]
      ];

      vocabs.forEach(v => {
        masterQuestions.push({ q: `„Äå${v[0]}„Äç„ÅÆÊÑèÂë≥„ÅØÔºü`, choices: [v[1], "Ëµ∞„Çã", "È£ü„Åπ„Çã", "Áú†„Çã"], a: v[1] });
        masterQuestions.push({ q: `„Äå${v[1]}„Äç„Å´„ÅÇ„Å¶„ÅØ„Åæ„ÇãËã±ÂçòË™û„ÅØÔºü`, choices: [v[0], "speak", "take", "make"], a: v[0] });
      });

      let pool = [...masterQuestions];
      let monster = {};
      let isBoss = false;

      function nextBattle() {
        player.winCount++;
        isBoss = player.winCount % 5 === 0;
        const monsters = [{n:"ÁÅ´„Çπ„É©",h:40,i:"üî•",t:"üî•"},{n:"Ê∞¥Á´ú",h:45,i:"üíß",t:"üíß"},{n:"Ê£ÆÁ≤æ",h:40,i:"üåø",t:"üåø"}];
        const bosses = [{n:"ÁÇéÂ∏ùÁéã",h:220,i:"üëπ",t:"üî•"},{n:"Ê∑±Êµ∑Á•û",h:250,i:"üî±",t:"üíß"},{n:"Â§ßÊ®πÈúä",h:230,i:"üå≥",t:"üåø"}];
        monster = isBoss ? {...bosses[Math.floor(Math.random()*bosses.length)]} : {...monsters[Math.floor(Math.random()*monsters.length)]};
        monster.maxH = monster.h;
        document.getElementById("monster-name").textContent = (isBoss?"„ÄêBOSS„Äë":"")+monster.n;
        document.getElementById("monster-image").textContent = monster.i;
        document.getElementById("monster-type").textContent = "Â±ûÊÄß: " + monster.t;
        document.getElementById("monster-name").style.color = isBoss ? "#ff4757" : "white";
        document.getElementById("log").textContent = "";
        document.getElementById("next").style.display = "none";
        loadQuestion();
        updateMonsterHp();
      }

      function loadQuestion() {
        if(pool.length === 0) pool = [...masterQuestions];
        const idx = Math.floor(Math.random()*pool.length);
        const qData = pool.splice(idx, 1)[0];
        document.getElementById("question").textContent = qData.q;
        const choicesEl = document.getElementById("choices");
        choicesEl.innerHTML = "";
        
        [...qData.choices].sort(()=>Math.random()-0.5).forEach(c => {
          const btn = document.createElement("button");
          btn.textContent = c;
          btn.onclick = () => checkAnswer(c, qData.a, btn);
          choicesEl.appendChild(btn);
        });
      }

      function checkAnswer(choice, answer, btn) {
        const buttons = document.querySelectorAll("#choices button");
        buttons.forEach(b => {
          b.disabled = true;
          // Ê≠£Ëß£„ÅÆÈÅ∏ÊäûËÇ¢„ÇíÂ∏∏„Å´Á∑ëËâ≤„Å´„Åô„Çã
          if(b.textContent === answer) b.classList.add("correct");
        });

        if (choice === answer) {
          let damage = elements[player.element] === monster.t ? (isBoss ? 45 : 35) : (isBoss ? 20 : 15);
          document.getElementById("log").textContent = "Ê≠£Ëß£ÔºÅÊîªÊíÉÊàêÂäüÔºÅ";
          monster.h -= damage;
        } else {
          // ÈñìÈÅï„Åà„Åü„Éú„Çø„É≥„ÇíËµ§Ëâ≤„Å´„Åô„Çã
          btn.classList.add("wrong");
          document.getElementById("log").textContent = "‰∏çÊ≠£Ëß£ÔºÅ„ÉÄ„É°„Éº„Ç∏ÔºÅ";
          player.hp -= (isBoss ? 25 : 15);
        }

        setTimeout(() => {
          if (monster.h <= 0) {
            document.getElementById("log").textContent = "ÂãùÂà©ÔºÅÊ¨°„ÅÆ„Éê„Éà„É´„Å∏ÈÄ≤„ÇÇ„ÅÜ";
            player.exp += isBoss ? 150 : 35;
            document.getElementById("next").style.display = "block";
            levelUpCheck();
          } else if (player.hp <= 0) {
            document.getElementById("log").textContent = "ÊïóÂåó‚Ä¶";
            player.hp = 100; player.winCount = 0;
            document.getElementById("next").textContent = "‚ñ∂ Âæ©Ê¥ª„Åô„Çã";
            document.getElementById("next").style.display = "block";
          } else {
            loadQuestion();
          }
          updateStatus();
          updateMonsterHp();
        }, 800);
      }

      function updateMonsterHp() {
        document.getElementById("monster-hp").style.width = Math.max((monster.h / monster.maxH)*100, 0) + "%";
      }

      function levelUpCheck() {
        if (player.exp >= player.level * 100) {
          player.level++; player.exp = 0;
          player.element = ["üî•", "üíß", "üåø"][player.level % 3];
        }
      }

      document.getElementById("next").onclick = () => {
        document.getElementById("next").textContent = "‚ñ∂ Ê¨°„ÅÆ„Éê„Éà„É´„Å∏";
        nextBattle();
      };

      function updateStatus() {
        document.getElementById("level").textContent = player.level;
        document.getElementById("hp").textContent = player.hp;
        document.getElementById("p-element").textContent = player.element;
      }

      updateStatus();
      nextBattle();
    });
  </script>
</body>
</html>
