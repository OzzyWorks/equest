<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>ENGLISH QUEST 100</title>
  <style>
    /* 1ç”»é¢ã«å¼·åˆ¶çš„ã«åã‚ã‚‹ãƒ­ã‚¸ãƒƒã‚¯ */
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      overflow: hidden; /* ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’ç¦æ­¢ */
    }
    body {
      font-family: sans-serif;
      background: #1e1e2f;
      color: #fff;
      display: flex;
      flex-direction: column; /* ç¸¦ã«ä¸¦ã¹ã‚‹ */
      box-sizing: border-box;
      padding: 10px;
    }

    /* ãƒ˜ãƒƒãƒ€ãƒ¼ï¼šå°ã•ãå›ºå®š */
    h1 { font-size: 1.1rem; margin: 0 0 5px 0; flex-shrink: 0; }

    /* ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ï¼šå°ã•ãå›ºå®š */
    #status {
      display: flex;
      justify-content: space-around;
      background: rgba(0,0,0,0.3);
      padding: 5px;
      font-size: 0.8rem;
      border-radius: 8px;
      flex-shrink: 0;
    }

    /* ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚¨ãƒªã‚¢ï¼šç”»é¢ã®é«˜ã•ã«åˆã‚ã›ã¦ä¼¸ç¸® */
    #monster {
      flex: 1; /* ä½™ã£ãŸã‚¹ãƒšãƒ¼ã‚¹ã‚’åˆ†ã‘åˆã† */
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      min-height: 0; /* flexå†…ã®é«˜ã•å´©ã‚Œé˜²æ­¢ */
    }
    #monster-image { font-size: 15vh; margin: 5px 0; line-height: 1; }
    #monster-name { font-size: 1rem; margin: 2px 0; }
    .hp-bar { width: 60%; height: 8px; background: #444; border-radius: 4px; overflow: hidden; }
    #monster-hp { height: 100%; background: #ff4757; width: 100%; transition: width 0.3s; }

    /* å•é¡Œã‚¨ãƒªã‚¢ï¼šæœ€é‡è¦é …ç›® */
    #question-area {
      flex: 1.5; /* å•é¡Œã¨é¸æŠè‚¢ã‚’å°‘ã—åºƒã‚ã«ç¢ºä¿ */
      display: flex;
      flex-direction: column;
      justify-content: center;
      min-height: 0;
    }
    #question {
      font-size: 0.95rem;
      margin-bottom: 10px;
      color: #feca57;
      font-weight: bold;
      padding: 0 5px;
    }
    #choices {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 6px;
    }
    #choices button {
      padding: 10px 2px;
      font-size: 0.8rem;
      border-radius: 6px;
      border: none;
      background: #f1f2f6;
      font-weight: bold;
      color: #2f3542;
    }

    /* ãƒ­ã‚°ã¨ãƒœã‚¿ãƒ³ï¼šæœ€ä¸‹éƒ¨ã«å›ºå®š */
    #footer-area {
      height: 80px; /* é«˜ã•ã‚’å›ºå®šã—ã¦ç”»é¢å¤–é€ƒã’ã‚’é˜²æ­¢ */
      flex-shrink: 0;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }
    #log { font-size: 0.85rem; color: #1dd1a1; margin-bottom: 5px; font-weight: bold; }
    #next {
      width: 90%;
      padding: 12px;
      font-size: 1rem;
      background: #ff9f43;
      border: none;
      border-radius: 20px;
      color: white;
      font-weight: bold;
      display: none; /* JSã§åˆ¶å¾¡ */
    }
    
    .correct { background: #4caf50 !important; color: white !important; }
    .wrong { background: #f44336 !important; color: white !important; }
  </style>
</head>
<body>
  <h1>âš”ï¸ ENGLISH QUEST</h1>
  
  <div id="status">
    <div>LV: <span id="level">1</span></div>
    <div>HP: <span id="hp">100</span></div>
    <div>å±æ€§: <span id="p-element">ğŸ”¥</span></div>
  </div>

  <div id="monster">
    <div id="monster-image">ğŸ¾</div>
    <div id="monster-name">...</div>
    <div class="hp-bar"><div id="monster-hp"></div></div>
    <div id="monster-type" style="font-size: 0.7rem; margin-top: 2px;"></div>
  </div>

  <div id="question-area">
    <div id="question"></div>
    <div id="choices"></div>
  </div>

  <div id="footer-area">
    <div id="log"></div>
    <button id="next">â–¶ æ¬¡ã®ãƒãƒˆãƒ«ã¸</button>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
        let player = { level: 1, exp: 0, hp: 100, element: "ğŸ”¥", winCount: 0 };
        const elements = { "ğŸ”¥": "ğŸ’§", "ğŸ’§": "ğŸŒ¿", "ğŸŒ¿": "ğŸ”¥" };
        const monsters = [
            { name: "ç«ã‚¹ãƒ©", hp: 40, img: "ğŸ”¥", type: "ğŸ”¥" },
            { name: "æ°´ç«œ", hp: 45, img: "ğŸ’§", type: "ğŸ’§" },
            { name: "æ£®ç²¾", hp: 40, img: "ğŸŒ¿", type: "ğŸŒ¿" }
        ];
        const bosses = [
            { name: "ç‚å¸ç‹", hp: 150, img: "ğŸ‘¹", type: "ğŸ”¥" },
            { name: "æ·±æµ·é¾", hp: 180, img: "ğŸ”±", type: "ğŸ’§" },
            { name: "å¤§æ¨¹éœŠ", hp: 160, img: "ğŸŒ³", type: "ğŸŒ¿" }
        ];

        // 100å•ã®å•é¡Œãƒ‡ãƒ¼ã‚¿
        const questions = [
            { q: "The man ( ) is standing there is my uncle.", choices: ["who", "which", "whose", "whom"], a: "who" },
            { q: "I have a watch ( ) was made in Japan.", choices: ["who", "which", "whom", "what"], a: "which" },
            { q: "This is the city ( ) I was born.", choices: ["where", "which", "who", "when"], a: "where" },
            { q: "I ( ) just finished my homework.", choices: ["have", "has", "am", "do"], a: "have" },
            { q: "How long have you ( ) in Tokyo?", choices: ["live", "lived", "living", "lives"], a: "lived" },
            { q: "I have ( ) to Okinawa twice.", choices: ["be", "go", "been", "gone"], a: "been" },
            { q: "It is difficult ( ) speak English.", choices: ["to", "for", "of", "at"], a: "to" },
            { q: "He is good at ( ) tennis.", choices: ["play", "playing", "to play", "played"], a: "playing" },
            { q: "If I ( ) you, I would go there.", choices: ["am", "is", "was", "were"], a: "were" },
            { q: "Can you ( ) me a favor?", choices: ["do", "make", "give", "tell"], a: "do" },
            { q: "She ( ) me about the news.", choices: ["told", "said", "spoke", "talked"], a: "told" }
        ];
        // 100å•ã«æ‹¡å¼µ
        const fillWords = ["decide","improve","avoid","increase","reduce","realize","provide","prepare","mention","various"];
        for(let i=questions.length; i<105; i++){
            let w = fillWords[i % fillWords.length];
            questions.push({q: `æ„å‘³ã¯ï¼Ÿ: ${w}`, choices: ["ã€œã‚’æ”¹å–„ã™ã‚‹","ã€œã‚’æ±ºã‚ã‚‹","ã€œã‚’é¿ã‘ã‚‹","ã€œã‚’å¢—ã‚„ã™"], a: i%4==0?"ã€œã‚’æ”¹å–„ã™ã‚‹":i%4==1?"ã€œã‚’æ±ºã‚ã‚‹":i%4==2?"ã€œã‚’é¿ã‘ã‚‹":"ã€œã‚’å¢—ã‚„ã™"});
        }

        let monster = {};
        let isBoss = false;
        const nextBtn = document.getElementById("next");

        function updateStatus() {
            document.getElementById("level").textContent = player.level;
            document.getElementById("hp").textContent = player.hp;
            document.getElementById("p-element").textContent = player.element;
        }

        function nextBattle() {
            player.winCount++;
            isBoss = player.winCount % 5 === 0;
            monster = isBoss ? { ...bosses[Math.floor(Math.random() * bosses.length)] } : { ...monsters[Math.floor(Math.random() * monsters.length)] };
            monster.maxHp = monster.hp;
            document.getElementById("monster-name").textContent = (isBoss ? "ã€BOSSã€‘" : "") + monster.name;
            document.getElementById("monster-image").textContent = monster.img;
            document.getElementById("monster-type").textContent = "å±æ€§: " + monster.type;
            document.getElementById("log").textContent = "";
            nextBtn.style.display = "none";
            loadQuestion();
            updateMonsterHp();
        }

        function loadQuestion() {
            let qData = questions[Math.floor(Math.random() * questions.length)];
            document.getElementById("question").textContent = qData.q;
            const choicesEl = document.getElementById("choices");
            choicesEl.innerHTML = "";
            qData.choices.forEach(c => {
                const btn = document.createElement("button");
                btn.textContent = c;
                btn.onclick = () => checkAnswer(c, qData.a, btn);
                choicesEl.appendChild(btn);
            });
        }

        function checkAnswer(choice, answer, btn) {
            document.querySelectorAll("#choices button").forEach(b => b.disabled = true);
            if (choice === answer) {
                btn.classList.add("correct");
                let damage = elements[player.element] === monster.type ? 40 : 20;
                document.getElementById("log").textContent = "æ­£è§£ï¼æ”»æ’ƒï¼";
                monster.hp -= damage;
            } else {
                btn.classList.add("wrong");
                document.getElementById("log").textContent = "ãƒŸã‚¹ï¼ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼";
                player.hp -= 20;
            }
            
            setTimeout(() => {
                if (monster.hp <= 0) {
                    document.getElementById("log").textContent = "ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’å€’ã—ãŸï¼";
                    player.exp += isBoss ? 100 : 30;
                    nextBtn.style.display = "block";
                    levelUpCheck();
                } else if (player.hp <= 0) {
                    document.getElementById("log").textContent = "æ•—åŒ—...";
                    player.hp = 100; player.winCount = 0;
                    nextBtn.textContent = "â–¶ å¾©æ´»ã™ã‚‹";
                    nextBtn.style.display = "block";
                } else {
                    loadQuestion();
                }
                updateStatus();
                updateMonsterHp();
            }, 600);
        }

        function updateMonsterHp() {
            document.getElementById("monster-hp").style.width = Math.max((monster.hp / monster.maxHp) * 100, 0) + "%";
        }

        function levelUpCheck() {
            if (player.exp >= player.level * 100) {
                player.level++; player.exp = 0;
                player.element = ["ğŸ”¥", "ğŸ’§", "ğŸŒ¿"][player.level % 3];
            }
        }

        nextBtn.addEventListener("click", () => { 
            nextBtn.textContent = "â–¶ æ¬¡ã®ãƒãƒˆãƒ«ã¸"; 
            nextBattle(); 
        });
        
        updateStatus();
        nextBattle();
    });
  </script>
</body>
</html>
