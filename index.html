<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>ENGLISH QUEST 230+</title>
  <style>
    html, body { height: 100%; margin: 0; padding: 0; overflow: hidden; background: #1a1a2e; color: #fff; font-family: 'Segoe UI', sans-serif; }
    body { display: flex; flex-direction: column; box-sizing: border-box; padding: 8px; }
    h1 { font-size: 0.9rem; margin: 0 0 5px 0; text-align: center; color: #eccc68; }
    #status { display: flex; justify-content: space-around; background: rgba(255,255,255,0.1); padding: 5px; font-size: 0.75rem; border-radius: 8px; flex-shrink: 0; border: 1px solid #444; }
    #monster-area { flex: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; min-height: 0; position: relative; }
    #monster-image { font-size: 10vh; margin: 2px 0; transition: transform 0.2s; }
    #monster-name { font-size: 0.85rem; margin: 2px 0; font-weight: bold; }
    .hp-bar-container { width: 60%; height: 6px; background: #333; border-radius: 3px; overflow: hidden; margin-bottom: 2px; }
    #monster-hp { height: 100%; background: #ff4757; width: 100%; transition: width 0.3s; }
    #monster-type { font-size: 0.65rem; color: #ced4da; }
    #question-area { flex: 1.4; display: flex; flex-direction: column; justify-content: center; min-height: 0; padding: 0 5px; }
    #question { font-size: 0.85rem; margin-bottom: 8px; color: #ffa502; font-weight: bold; text-align: center; min-height: 2.8em; display: flex; align-items: center; justify-content: center; line-height: 1.3; }
    #choices { display: grid; grid-template-columns: 1fr 1fr; gap: 6px; }
    #choices button { padding: 10px 4px; font-size: 0.75rem; border-radius: 6px; border: none; background: #f1f2f6; font-weight: bold; color: #2f3542; cursor: pointer; -webkit-tap-highlight-color: transparent; }
    #footer { height: 65px; flex-shrink: 0; display: flex; flex-direction: column; justify-content: center; align-items: center; }
    #log { font-size: 0.75rem; color: #2ed573; margin-bottom: 4px; height: 1rem; font-weight: bold; }
    #next { width: 85%; padding: 10px; font-size: 0.9rem; background: #ff7f50; border: none; border-radius: 20px; color: white; font-weight: bold; display: none; box-shadow: 0 4px #e67e22; }
    .correct { background: #2ed573 !important; color: white !important; }
    .wrong { background: #ff4757 !important; color: white !important; }
  </style>
</head>
<body>
  <h1>‚öîÔ∏è ENGLISH QUEST 230</h1>
  <div id="status">
    <div>LV: <span id="level">1</span></div>
    <div>HP: <span id="hp">100</span></div>
    <div>Ëá™ÂàÜ: <span id="p-element">üî•</span></div>
  </div>
  <div id="monster-area">
    <div id="monster-image">üêæ</div>
    <div id="monster-name">Loading...</div>
    <div class="hp-bar-container"><div id="monster-hp"></div></div>
    <div id="monster-type"></div>
  </div>
  <div id="question-area">
    <div id="question"></div>
    <div id="choices"></div>
  </div>
  <div id="footer">
    <div id="log"></div>
    <button id="next">‚ñ∂ Ê¨°„ÅÆ„Éê„Éà„É´„Å∏</button>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      let player = { level: 1, exp: 0, hp: 100, element: "üî•", winCount: 0 };
      const elements = { "üî•": "üíß", "üíß": "üåø", "üåø": "üî•" };

      // 115Âïè„Åã„ÇâÂÄç‰ª•‰∏ä„ÅÆ230Âïè‰ª•‰∏ä„Å´Êã°Âºµ„Åó„Åü„É™„Çπ„Éà
      const masterQuestions = [
        // ÊñáÊ≥ï„Çª„ÇØ„Ç∑„Éß„É≥ÔºàÈñ¢‰øÇË©û„ÄÅÊØîËºÉ„ÄÅÂÆå‰∫ÜÂΩ¢„ÄÅÂä©ÂãïË©û„ÄÅ‰∏çÂÆöË©û„Å™„Å©Ôºâ
        { q: "This is the car ( ) my father bought.", choices: ["which", "who", "whom", "whose"], a: "which" },
        { q: "I know a boy ( ) can play the violin.", choices: ["who", "which", "whose", "what"], a: "who" },
        { q: "I have ( ) to London three times.", choices: ["been", "gone", "be", "go"], a: "been" },
        { q: "If I ( ) a bird, I would fly to you.", choices: ["were", "am", "was", "is"], a: "were" },
        { q: "I am looking forward to ( ) you.", choices: ["seeing", "see", "saw", "to see"], a: "seeing" },
        { q: "She is ( ) than me.", choices: ["taller", "tall", "tallest", "more tall"], a: "taller" },
        { q: "You ( ) not enter this room.", choices: ["must", "can", "may", "will"], a: "must" },
        { q: "I forgot ( ) the window.", choices: ["to close", "closing", "close", "closed"], a: "to close" },
        { q: "He is ( ) popular boy in class.", choices: ["the most", "most", "more", "much"], a: "the most" },
        { q: "This cake ( ) by my sister yesterday.", choices: ["was made", "is made", "made", "makes"], a: "was made" },
        { q: "I don't know ( ) to solve it.", choices: ["how", "what", "which", "who"], a: "how" },
        { q: "He ( ) have been sick yesterday.", choices: ["must", "can", "should", "will"], a: "must" },
        { q: "The news made us ( ).", choices: ["happy", "happily", "happiness", "to happy"], a: "happy" },
        { q: "I've lived here ( ) 2010.", choices: ["since", "for", "during", "at"], a: "since" },
        { q: "Would you like ( ) to drink?", choices: ["something", "anything", "nothing", "everything"], a: "something" }
      ];

      // ÂçòË™û„ÉªÁÜüË™û„ÅÆÂ§ßÂπÖÊã°Âºµ„Éá„Éº„ÇøÔºà100„Çª„ÉÉ„Éà‰ª•‰∏äËøΩÂä†Ôºâ
      const wordPairs = [
        ["admit","Ë™ç„ÇÅ„Çã"],["avoid","ÈÅø„Åë„Çã"],["consider","„Çà„ÅèËÄÉ„Åà„Çã"],["decide","Ê±∫ÂÆö„Åô„Çã"],["expect","ÊúüÂæÖ„Åô„Çã"],
        ["imagine","ÊÉ≥ÂÉè„Åô„Çã"],["improve","Âêë‰∏ä„Åï„Åõ„Çã"],["increase","Â¢ó„ÇÑ„Åô"],["decrease","Ê∏õ„Çâ„Åô"],["manage","‰Ωï„Å®„Åã„ÇÑ„ÇäÈÅÇ„Åí„Çã"],
        ["mention","Ë®ÄÂèä„Åô„Çã"],["offer","Êèê‰æõ„Åô„Çã"],["prepare","Ê∫ñÂÇô„Åô„Çã"],["provide","‰æõÁµ¶„Åô„Çã"],["realize","Ê∞ó„Å•„Åè"],
        ["receive","Âèó„ÅëÂèñ„Çã"],["reduce","Ê∏õ„Çâ„Åô"],["remain","„Äú„ÅÆ„Åæ„Åæ„Åß„ÅÑ„Çã"],["require","ÂøÖË¶Å„Å®„Åô„Çã"],["suggest","ÊèêÊ°à„Åô„Çã"],
        ["accept","Âèó„ÅëÂÖ•„Çå„Çã"],["achieve","ÈÅîÊàê„Åô„Çã"],["allow","Ë®±ÂèØ„Åô„Çã"],["cause","ÂéüÂõ†„Å®„Å™„Çã"],["create","ÂâµÈÄ†„Åô„Çã"],
        ["depend","‰æùÂ≠ò„Åô„Çã"],["describe","ÊèèÂÜô„Åô„Çã"],["develop","Áô∫ÈÅî„Åï„Åõ„Çã"],["exist","Â≠òÂú®„Åô„Çã"],["express","Ë°®Áèæ„Åô„Çã"],
        ["identify","ÁâπÂÆö„Åô„Çã"],["indicate","Êåá„ÅóÁ§∫„Åô"],["influence","ÂΩ±Èüø„Çí‰∏é„Åà„Çã"],["maintain","Á∂≠ÊåÅ„Åô„Çã"],["observe","Ë¶≥ÂØü„Åô„Çã"],
        ["perform","Ë°å„ÅÜ"],["prevent","Â¶®„Åí„Çã"],["produce","ÁîüÁî£„Åô„Çã"],["protect","‰øùË≠∑„Åô„Çã"],["publish","Âá∫Áâà„Åô„Çã"],
        ["recognize","Ë™çË≠ò„Åô„Çã"],["replace","Âèñ„Å£„Å¶‰ª£„Çè„Çã"],["respond","ÂèçÂøú„Åô„Çã"],["satisfy","Ê∫ÄË∂≥„Åï„Åõ„Çã"],["separate","ÂàÜ„Åë„Çã"],
        ["various","Êßò„ÄÖ„Å™"],["common","ÂÖ±ÈÄö„ÅÆ"],["necessary","ÂøÖË¶Å„Å™"],["important","ÈáçË¶Å„Å™"],["difficult","Èõ£„Åó„ÅÑ"],
        ["environment","Áí∞Â¢É"],["education","ÊïôËÇ≤"],["government","ÊîøÂ∫ú"],["situation","Áä∂Ê≥Å"],["opportunity","Ê©ü‰ºö"],
        ["benefit","Âà©Áõä"],["culture","ÊñáÂåñ"],["experience","ÁµåÈ®ì"],["individual","ÂÄã‰∫∫"],["material","ÊùêÊñô"],
        ["particular","ÁâπÂÆö„ÅÆ"],["available","Âà©Áî®ÂèØËÉΩ„Å™"],["likely","„Äú„Åó„Åù„ÅÜ„Å™"],["possible","ÂèØËÉΩ„Å™"],["successful","ÊàêÂäü„Åó„Åü"],
        ["tradition","‰ºùÁµ±"],["technology","ÊäÄË°ì"],["science","ÁßëÂ≠¶"],["knowledge","Áü•Ë≠ò"],["resource","Ë≥áÊ∫ê"],
        ["attitude","ÊÖãÂ∫¶"],["purpose","ÁõÆÁöÑ"],["opinion","ÊÑèË¶ã"],["result","ÁµêÊûú","ÂéüÂõ†","ÁêÜÁî±","Ë≤¨‰ªª"],
        ["actually","ÂÆü„ÅØ"],["especially","Áâπ„Å´"],["probably","„Åä„Åù„Çâ„Åè"],["recently","ÊúÄËøë"],["suddenly","Á™ÅÁÑ∂"],
        ["look after","‰∏ñË©±„Çí„Åô„Çã"],["take part in","ÂèÇÂä†„Åô„Çã"],["carry out","ÂÆüË°å„Åô„Çã"],["rely on","È†º„Çã"],["turn off","Ê∂à„Åô"],
        ["believe in","‰ø°„Åò„Çã"],["succeed in","ÊàêÂäü„Åô„Çã"],["agree with","ÂêåÊÑè„Åô„Çã"],["suffer from","Ëã¶„Åó„ÇÄ"],["belong to","Â±û„Åô„Çã"],
        ["stand for","Ë±°Âæ¥„Åô„Çã"],["put off","Âª∂Êúü„Åô„Çã"],["call off","‰∏≠Ê≠¢„Åô„Çã"],["run out of","‰Ωø„ÅÑÊûú„Åü„Åô"],["get over","‰πó„ÇäË∂ä„Åà„Çã"],
        ["amount","Èáè"],["quality","Ë≥™"],["standard","Âü∫Ê∫ñ"],["effect","ÂäπÊûú"],["danger","Âç±Èô∫"],
        ["encourage","Âä±„Åæ„Åô"],["discover","Áô∫Ë¶ã„Åô„Çã"],["explain","Ë™¨Êòé„Åô„Çã"],["protect","ÂÆà„Çã"],["support","ÊîØ„Åà„Çã"],
        ["abstract","ÊäΩË±°ÁöÑ„Å™"],["concrete","ÂÖ∑‰ΩìÁöÑ„Å™"],["constant","Áµ∂„ÅàÈñì„Å™„ÅÑ"],["efficient","ÂäπÁéáÁöÑ„Å™"],["negative","Âê¶ÂÆöÁöÑ„Å™"],
        ["positive","ËÇØÂÆöÁöÑ„Å™"],["previous","‰ª•Ââç„ÅÆ"],["primary","‰∏ªË¶Å„Å™"],["rare","Áèç„Åó„ÅÑ"],["significant","ÈáçË¶Å„Å™"],
        ["visible","ÁõÆ„Å´Ë¶ã„Åà„Çã"],["ancient","Âè§‰ª£„ÅÆ"],["modern","Áèæ‰ª£„ÅÆ"],["global","Âú∞ÁêÉË¶èÊ®°„ÅÆ"],["local","Âú∞ÂÖÉ„ÅÆ"],
        ["complex","Ë§áÈõë„Å™"],["simple","ÂçòÁ¥î„Å™"],["major","‰∏ªË¶Å„Å™"],["minor","ÈáçË¶Å„Åß„Å™„ÅÑ"],["legal","Ê≥ïÂæã‰∏ä„ÅÆ"],
        ["accurate","Ê≠£Á¢∫„Å™"],["vague","„ÅÇ„ÅÑ„Åæ„ÅÑ„Å™"],["stable","ÂÆâÂÆö„Åó„Åü"],["rough","Á≤ó„ÅÑ"],["smooth","Êªë„Çâ„Åã„Å™"],
        ["broad","Â∫É„ÅÑ"],["narrow","Áã≠„ÅÑ"],["tough","Âõ∞Èõ£„Å™"],["sharp","Èã≠„ÅÑ"],["dull","Èàç„ÅÑ"]
      ];

      // wordPairs„ÇímasterQuestionsÂΩ¢Âºè„Å´Â§âÊèõ„Åó„Å¶ËøΩÂä†Ôºà2ÂÄç‰ª•‰∏ä„ÅÆÈáè„Å∏Ôºâ
      wordPairs.forEach(w => {
        // ÂçòË™û„ÅÆÊÑèÂë≥„ÇíÂïè„ÅÜÂïèÈ°å
        masterQuestions.push({ q: `ÊÑèÂë≥„ÅØÔºü: ${w[0]}`, choices: [w[1], "Ëµ∞„Çã", "Â£ä„Åô", "Ê≠å„ÅÜ"], a: w[1] });
        // ÊÑèÂë≥„Åã„ÇâÂçòË™û„ÇíÈÅ∏„Å∂ÂïèÈ°åÔºà„Éê„É™„Ç®„Éº„Ç∑„Éß„É≥Â¢óÔºâ
        masterQuestions.push({ q: `„Äå${w[1]}„Äç„Å´„ÅÇ„Å¶„ÅØ„Åæ„ÇãËã±ÂçòË™û„ÅØÔºü`, choices: [w[0], "speak", "take", "make"], a: w[0] });
      });

      let currentPool = [...masterQuestions];
      let monster = {};
      let isBoss = false;

      function updateStatus() {
        document.getElementById("level").textContent = player.level;
        document.getElementById("hp").textContent = player.hp;
        document.getElementById("p-element").textContent = player.element;
      }

      function nextBattle() {
        player.winCount++;
        isBoss = player.winCount % 5 === 0;
        const monsters = [{n:"ÁÅ´„Çπ„É©",h:40,i:"üî•",t:"üî•"},{n:"Ê∞¥Á´ú",h:45,i:"üíß",t:"üíß"},{n:"Ê£ÆÁ≤æ",h:40,i:"üåø",t:"üåø"}];
        const bosses = [{n:"ÁÇéÂ∏ù",h:220,i:"üëπ",t:"üî•"},{n:"Êµ∑Èæç",h:250,i:"üî±",t:"üíß"},{n:"Ê£ÆÁ•û",h:230,i:"üå≥",t:"üåø"}];
        monster = isBoss ? {...bosses[Math.floor(Math.random()*bosses.length)]} : {...monsters[Math.floor(Math.random()*monsters.length)]};
        monster.maxH = monster.h;
        document.getElementById("monster-name").textContent = (isBoss?"„ÄêBOSS„Äë":"")+monster.n;
        document.getElementById("monster-image").textContent = monster.i;
        document.getElementById("monster-type").textContent = "Â±ûÊÄß: " + monster.t;
        document.getElementById("monster-name").style.color = isBoss ? "#ff4757" : "white";
        document.getElementById("log").textContent = "";
        document.getElementById("next").style.display = "none";
        loadQuestion();
        updateMonsterHp();
      }

      function loadQuestion() {
        if(currentPool.length === 0) currentPool = [...masterQuestions];
        const idx = Math.floor(Math.random()*currentPool.length);
        const qData = currentPool.splice(idx, 1)[0];
        document.getElementById("question").textContent = qData.q;
        const choicesEl = document.getElementById("choices");
        choicesEl.innerHTML = "";
        [...qData.choices].sort(()=>Math.random()-0.5).forEach(c => {
          const btn = document.createElement("button");
          btn.textContent = c;
          btn.onclick = () => checkAnswer(c, qData.a, btn);
          choicesEl.appendChild(btn);
        });
      }

      function checkAnswer(choice, answer, btn) {
        document.querySelectorAll("#choices button").forEach(b => b.disabled = true);
        if (choice === answer) {
          btn.classList.add("correct");
          let isAdv = elements[player.element] === monster.t;
          let damage = isAdv ? (isBoss ? 45 : 35) : (isBoss ? 20 : 15);
          document.getElementById("log").textContent = isAdv ? "Âº±ÁÇπÁõ¥ÊíÉÔºÅ" : "Ê≠£Ëß£ÔºÅ";
          monster.h -= damage;
          document.getElementById("monster-image").style.transform = "scale(1.2)";
          setTimeout(() => document.getElementById("monster-image").style.transform = "scale(1)", 200);
        } else {
          btn.classList.add("wrong");
          document.getElementById("log").textContent = "‰∏çÊ≠£Ëß£ÔºÅ";
          player.hp -= (isBoss ? 25 : 15);
        }
        setTimeout(() => {
          if (monster.h <= 0) {
            document.getElementById("log").textContent = isBoss ? "„Éú„ÇπÊíÉÁ†¥ÔºÅ" : "ÂãùÂà©ÔºÅ";
            player.exp += isBoss ? 150 : 35;
            document.getElementById("next").style.display = "block";
            levelUpCheck();
          } else if (player.hp <= 0) {
            document.getElementById("log").textContent = "ÊïóÂåó‚Ä¶";
            player.hp = 100; player.winCount = 0;
            document.getElementById("next").textContent = "‚ñ∂ Âæ©Ê¥ª„Åô„Çã";
            document.getElementById("next").style.display = "block";
          } else {
            loadQuestion();
          }
          updateStatus();
          updateMonsterHp();
        }, 600);
      }

      function updateMonsterHp() {
        document.getElementById("monster-hp").style.width = Math.max((monster.h / monster.maxH)*100, 0) + "%";
      }

      function levelUpCheck() {
        if (player.exp >= player.level * 100) {
          player.level++; player.exp = 0;
          player.element = ["üî•", "üíß", "üåø"][player.level % 3];
          document.getElementById("log").textContent += " LV UP!";
        }
      }

      document.getElementById("next").onclick = () => {
        document.getElementById("next").textContent = "‚ñ∂ Ê¨°„ÅÆ„Éê„Éà„É´„Å∏";
        nextBattle();
      };

      updateStatus();
      nextBattle();
    });
  </script>
</body>
</html>
